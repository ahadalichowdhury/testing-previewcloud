services:
  frontend:
    dockerfile: ./frontend/Dockerfile
    context: ./frontend # Build context (like DigitalOcean tutorial)
    port: 80
    env:
      REACT_APP_API_URL: ${API_URL} # Resolved by PreviewCloud
      NODE_ENV: production
    root: true

  api:
    dockerfile: ./backend/Dockerfile
    context: ./backend # Separate build context
    port: 5000
    path: /api
    env:
      DATABASE_URL: ${DATABASE_URL}
      NODE_ENV: production

database:
  type: postgres
  migrations: ./migrations